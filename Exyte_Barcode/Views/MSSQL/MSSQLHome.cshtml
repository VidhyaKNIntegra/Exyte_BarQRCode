
@{
    ViewBag.Title = "MSSQLHome";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<br />
<div class="gx-container">
    <div class="gx-main-container">
        <div class="gx-main-content">
            <!--gx-wrapper-->
            <div class="gx-wrapper">

                <div class="row">
                    <div class="col-lg-12">
                        <div class="page-heading d-sm-flex justify-content-sm-between align-items-sm-center" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            <h2 class="title mb-3 mb-sm-0">
                                Generate Barcode & QR Code
                            </h2>
                            <nav class="mb-0 breadcrumb">
                                <a style="float:right; margin-right:10px;"><i class='zmdi zmdi-plus-circle-o zmdi-hc-fw'></i> </a>
                            </nav>
                        </div>
                        <div class="gx-card max-hight-scroll">
                            <div class="gx-card-body collapse show" id="collapseOne">
                                <form id="rootwizard-2" class="form-wizard validate-form-wizard validate">
                                    <div class="wizard-navbar">
                                        <ul>
                                            <li class="active"><a class="active show" href="#tab2-1" data-toggle="tab"><span class="wz-number">1</span> <span class="wz-label">DB Connection</span></a></li>
                                            <li><a href="#tab2-2" data-toggle="tab"><span class="wz-number">2</span> <span class="wz-label">Table Filter</span></a></li>
                                            <li><a href="#tab2-3" data-toggle="tab"><span class="wz-number">3</span> <span class="wz-label">Select Columns</span></a></li>
                                            <li><a href="#tab2-4" data-toggle="tab"><span class="wz-number">4</span> <span class="wz-label">Table</span></a></li>
                                        </ul>
                                    </div>
                                    <div class="tab-content">
                                        <div class="tab-pane  active" id="tab2-1">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="serverName" class="control-label">Server</label>
                                                        <input placeholder="Server" type="text" class="form-control required" name="serverName" id="serverName">
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="userName" class="control-label">Username</label>
                                                        <input placeholder="username" type="text" class="form-control required" name="userName" id="userName">
                                                        <span id="userNameErr" style="font-size:12px;color:red;"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="password" class="control-label">Password</label>
                                                        <input placeholder="password" type="password" class="form-control required" name="password" id="password">
                                                        <span id="PasswordErr" style="font-size:12px;color:red;"></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="prefixName" class="control-label">Prefix database</label>
                                                        <input placeholder="Prefix" type="text" class="form-control" name="prefixName" id="prefixName">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <input type="checkbox" name="Windows" id="Windows" value="windows" /> Windows Authentication?
                                                        @*<button class="btn btn-primary" onclick="LoadDatabases()">Load Databases</button>*@
                                                        <img src="~/images/spin-icon-2.gif" id="loadIcon" style="width:25px;height:25px;" />
                                                        <span id="connectErr" style="font-size:12px;color:red;"></span>
                                                        <span id="connectSuccess" style="font-size:12px;color:green;"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tab2-2">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="Databases" class="control-label">Select Database</label>
                                                        <select class="form-control" id="Databases" onchange="LoadTables()"><option value="choose">choose</option></select>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="emailfield" class="control-label">Select Category</label>
                                                        <select class="form-control" id="Tables" onchange="LoadColumns()"><option value="choose">choose</option></select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tab2-3">
                                            <div class="row">
                                                <div class="col-md-1"></div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="AvailableDpdwnlist" class="control-label">Available Columns</label>
                                                        <select class="form-control" style="height:110px;width:220px;" multiple id="AvailableDpdwnlist"><option></option></select>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <br /><br />
                                                    <a class="btn btn-primary" id="forwardToSelectDrpdwn" onclick="forwardToSelectDrpdwn()">>></a><br /><br />
                                                    <a class="btn btn-primary" id="DisSelectDrpdwn" onclick="DisSelectDrpdwn()"><<</a>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="SelectedDpdwnlist" class="control-label">Selected Columns</label>
                                                        <select class="form-control" style="height:110px;width:220px" multiple id="SelectedDpdwnlist"><option></option></select>
                                                    </div>
                                                </div>
                                            </div>                                            
                                            <div class="row">
                                                <div class="col-md-1"></div>
                                                <div class="col-md-4"></div>
                                                <div class="col-md-2"></div>
                                                <div class="col-md-4">
                                                    <div class="form-group">                                                        
                                                        <a class="btn btn-primary" onclick="Run()">Run</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tab2-4">
                                            <div class="row">
                                                <table class="table table-striped table-bordered table-hover dataTables-example" id="userTable"></table>
                                                <table class="table table-striped table-bordered table-hover dataTables-example" id="SearchTable"></table>
                                                <table class="table table-striped table-bordered table-hover dataTables-example" id="HashTable"></table>
                                            </div>                                            
                                        </div>
                                        <ul class="pager wizard">
                                            <li class="previous"><a href="javascript:void(0)"><i class="icon-left-open"></i>Previous</a></li>
                                            <li class="next" id="loadButton"><a href="javascript:void(0)" onclick="LoadDatabases()">Next<i class="icon-right-open"></i></a> </li>
                                            @*<li class="next" id="RunButton"><a href="javascript:void(0)" onclick="Run()">Next<i class="icon-right-open"></i></a> </li>*@
                                            <li class="next" id="nextbutton"><a href="javascript:void(0)">Next<i class="icon-right-open"></i></a> </li>
                                        </ul>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>


</div>

<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog" style="max-width:900px">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">QR Code</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-2">

                    </div>
                    <div class="col-md-4">
                        <img id="qrCode" src="" width="190" height="190" />
                        @*<img id="qrCode" src="" style="width:200px;height:200px"/>*@
                    </div>
                    <div class="col-md-4">
                        <label id="qrcodeLbl"></label>
                    </div>
                    <div class="col-md-2">

                    </div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="PrintImage('qrCode')">Print</button>
                @*<button type="button" class="btn btn-primary">Pdf</button>*@                
            </div>
        </div>

    </div>
</div>

<div class="modal fade" id="myModal2" role="dialog">
    <div class="modal-dialog" style="max-width:900px">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Barode</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-1"></div>
                    <div class="col-md-5">
                        <img id="barcode" src="" width="300" height="190" />
                    </div>
                    <div class="col-md-5">
                        <label id="barcodeLbl"></label>
                    </div>
                    <div class="col-md-1"></div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" onclick="PrintImage('barcode')">Print</button>
                @*<button type="button" class="btn btn-primary">Pdf</button>*@
            </div>
        </div>

    </div>
</div>

<script>



    $('#tab2-3').submit(function (event) {
        event.preventDefault();
    });
    $('#nextbutton').hide();
    $('#loadIcon').hide();
    $('#Windows').val($(this).is(':checked'));

    $('#Windows').change(function () {
        if (!$(this).is(':checked')) {
            $('#userName').attr('disabled', false);
            $('#password').attr('disabled', false);
        }
        else {
            $('#userName').val('');
            $('#password').val('');
            $('#userName').attr('disabled', true);
            $('#password').attr('disabled', true);
        }

    });

    $('#encrypt').change(function () {
        $('#decrypt').prop('checked', false);
    });
    $('#decrypt').change(function () {
        $('#encrypt').prop('checked', false);
    });

    $('#Windows').click(function () {
        if (!$(this).is(':checked')) {
            //return confirm("Are you sure?");

        }
    });

    $("#defaultOpen").css("color", "gray");
    $("#defaultOpen").css("background-color", "white");

    function LoadDatabases() {
        $('#userNameErr').text('');
        $('#PasswordErr').text('');
        $('#serverErr').text('');
        $('#connectErr').text('');
        $('#connectSuccess').text('');
        var dataSource = $('#serverName').val();
        var UserName = $('#userName').val();
        var Password = $('#password').val();
        var prefixName = $('#prefixName').val();
        var auth = $("#Windows").is(":checked") ? "true" : "false";
        if (dataSource == undefined || dataSource == "") {
            $('#serverErr').text('Please enter the server Name');
        }
        else if (auth == "false" && (UserName == '' || Password == '')) {
            $('#userNameErr').text('Enter the UserName');
            $('#PasswordErr').text('Enter the Password');
        }
        else {
            $('#loadIcon').show();
            Data = {
                DataSource: dataSource,
                UserName: UserName,
                Password: Password,
                DataBase: prefixName
            }
            $.ajax({
                type: "POST",
                //url: "/MSSQL/GetDatabases",
                url:'@Url.Action("GetDatabases", "MSSQL")',
                data: ko.toJSON(Data),
                contentType: "application/json",
                success: function (data) {
                    if (data[0] == 'failed') {
                        alert('failed to connect');
                        $('#loadIcon').hide();
                        $('#connectErr').text('Failed to Connect Server');
                    }
                    else {
                        $('#loadIcon').hide();
                        $('#connectSuccess').text('Server Connected');
                        $('#Databases').empty();
                        var option = '';
                        for (var i = 0; i < data.length; i++) {
                            option += '<option value="' + data[i] + '">' + data[i] + '</option>';
                        }
                        $('#Databases').append(option);
                        var option1 = '<option value="choose" selected>choose </option>';
                        $('#Databases').append(option1);
                        $('#loadButton').hide();
                        $('#nextbutton').show();
                    }


                },
                error: function (error) {
                    alert(error.status + " " + error.statusText);
                }
            });
        }
    }

    @*function LoadTables() {

        var dbName = $('#Databases').val();
        cData = {
            DataBase: dbName
        }
        $.ajax({
            type: "POST",
            //url: "/MSSQL/GetTables",
            url:'@Url.Action("GetTables", "MSSQL")',
            data: ko.toJSON(cData),
            contentType: "application/json",
            success: function (data) {
                $('#Tables').empty();
                var option = '';
                for (var i = 0; i < data.length; i++) {
                    option += '<option value="' + data[i] + '">' + data[i] + '</option>';
                }
                $('#Tables').append(option);
                var option1 = '<option value="choose" selected>choose </option>';
                $('#Tables').append(option1);
            },
            error: function (error) {
                alert(error.status + " " + error.statusText);
            }
        });
    }*@

    function LoadTables() {

        var dbName = $('#Databases').val();
        cData = {
            DataBase: dbName
        }
        $.ajax({
            type: "POST",
            url:'@Url.Action("GetCategory", "MSSQL")',
            data: ko.toJSON(cData),
            contentType: "application/json",
            success: function (data) {
                $('#Tables').empty();
                var option = '';
                for (var i = 0; i < data.length; i++) {
                    option += '<option value="' + data[i] + '">' + data[i] + '</option>';
                }
                $('#Tables').append(option);
                var option1 = '<option value="choose" selected>choose </option>';
                $('#Tables').append(option1);
            },
            error: function (error) {
                alert(error.status + " " + error.statusText);
            }
        });
    }

    function loadData() {
        var TableName = $('#Tables').val();
        var dbName = $('#Databases').val();

        $.ajax({
            type: "GET",
            //url: "/MSSQL/GetTableRecords",
            url:'@Url.Action("GetTableRecords", "MSSQL")',
            data: {
                'dataBase': dbName,
                'TableName': TableName
            },
            contentType: "application/json",
            success: function (data) {
                $("#userTable").empty();
                var response = JSON.parse(data);
                var head = "<thead class='thead-inverse'><tr>";
                $.each(response[0], function (k, v) {
                    head = head + "<th scope='row' style='content-align:left;'>" + k.toString() + "</th>";
                })
                head = head + "</thead></tr>";

                $("#userTable ").append(head);
                var body = "<tbody><tr>";
                $.each(response, function (index, value) {
                    body = body + "<tr>";
                    $.each(value, function (key, val) {
                        body = body + "<td>" + val + "</td>";
                    })
                    body = body + "</tr>";
                })
                body = body + "</tbody>";
                $("#HashTable").hide();
                $("#SearchTable").hide();
                $("#userTable").append(body);//append body
            },
            error: function (error) {
                alert(error.status + " " + error.statusText);
            }
        });
    }

    var cols = new Array();

    @*function LoadColumns() {
        if ($('#Tables').val() == "choose") {
            alert('Please select the Table');
            $('#columns').val('choose');
            $('#searchText').val('');
            $('#SelectedDpdwnlist').empty();
        }
        else {
            var TableName = $('#Tables').val();
            var dbName = $('#Databases').val();

            $.ajax({
                type: "GET",
                //url: "/MSSQL/GetColumns",
                url:'@Url.Action("GetColumns", "MSSQL")',
                data: {
                    'dataBase': dbName,
                    'TableName': TableName
                },
                contentType: "application/json",
                success: function (data) {
                    $('#columns').empty();
                    var option = '';
                    for (var i = 0; i < data.length; i++) {
                        option += '<option value="' + data[i] + '">' + data[i] + '</option>';
                    }
                    $("#userTable").show();
                    $("#SearchTable").hide();
                    $('#columns').append(option);
                    var option1 = '<option value="choose" selected>choose </option>';
                    $('#columns').append(option1);
                    $("#columns option[value='PnPID']").remove();
                    $('#AvailableDpdwnlist').empty();
                    $('#AvailableDpdwnlist').append(option);
                    $('#SelectedDpdwnlist').empty();
                    cols = [];
                    cols = data;
                    $("#AvailableDpdwnlist option[value='PnPID']").remove();

                    $('#searchText').val('');
                },
                error: function (error) {
                    alert(error.status + " " + error.statusText);
                }
            });

            loadData();
        }
    }*@

    function LoadColumns() {
        if ($('#Tables').val() == "choose") {
            alert('Please select the Table');
            $('#columns').val('choose');
            $('#searchText').val('');
            $('#SelectedDpdwnlist').empty();
        }
        else {
            var CatName = $('#Tables').val();
            var dbName = $('#Databases').val();

            $.ajax({
                type: "GET",
                url:'@Url.Action("GetColumns", "MSSQL")',
                data: {
                    'dataBase': dbName,
                    'TableName': CatName
                },
                contentType: "application/json",
                success: function (data) {
                    $('#columns').empty();
                    var option = '';
                    for (var i = 0; i < data.length; i++) {
                        option += '<option value="' + data[i] + '">' + data[i] + '</option>';
                    }
                    $("#userTable").show();
                    $("#SearchTable").hide();
                    $('#columns').append(option);
                    var option1 = '<option value="choose" selected>choose </option>';
                    $('#columns').append(option1);
                    $("#columns option[value='PnPID']").remove();
                    $('#AvailableDpdwnlist').empty();
                    $('#AvailableDpdwnlist').append(option);
                    $('#SelectedDpdwnlist').empty();
                    cols = [];
                    cols = data;
                    $("#AvailableDpdwnlist option[value='PnPID']").remove();

                    $('#searchText').val('');
                },
                error: function (error) {
                    alert(error.status + " " + error.statusText);
                }
            });

            loadData();
        }
    }

    function SearchColumnData() {
        $('#columnErr').text('');
        $('#SearchErr').text('');
        if ($('#columns').val() == "choose") {
            $('#columnErr').text('Please Select the column');
        } else
            if ($('#searchText').val() == "") {
                $('#SearchErr').text('Please enter search text');
            }
            else {
                var TableName = $('#Tables').val();
                var dbName = $('#Databases').val();
                var columnName = $('#columns').val();
                var wildcard = $('#wildCards').val();
                var searchText = $('#searchText').val();
                Data = {
                    DataBase: dbName,
                    TableName: TableName,
                    ColumnName: columnName,
                    Wildcard: wildcard,
                    SearchText: searchText
                }
                $.ajax({
                    type: "POST",
                    //url: "/MSSQL/GetColumnFiterTableData",
                    url:'@Url.Action("GetColumnFiterTableData", "MSSQL")',
                    data: ko.toJSON(Data),
                    contentType: "application/json",
                    success: function (data) {
                        $("#SearchTable").empty();
                        var response = JSON.parse(data);
                        var head = "<thead class='thead-inverse'><tr>";
                        $.each(response[0], function (k, v) {
                            head = head + "<th scope='row' style='content-align:left;'>" + k.toString() + "</th>";
                        })
                        head = head + "</thead></tr>";

                        $("#SearchTable ").append(head);
                        var body = "<tbody><tr>";
                        $.each(response, function (index, value) {
                            body = body + "<tr>";
                            $.each(value, function (key, val) {
                                body = body + "<td>" + val + "</td>";
                            })
                            body = body + "</tr>";
                        })
                        body = body + "</tbody>";
                        $("#userTable").hide();
                        $("#SearchTable").show();
                        $("#SearchTable").append(body);//append body
                    },
                    error: function (error) {
                        alert(error.status + " " + error.statusText);
                    }
                });
            }

    }

    function forwardToSelectDrpdwn() {
        var options1 = $('#SelectedDpdwnlist option');
        var selectedDdp1 = $.map(options1, function (option) {
            return option.value;
        });

        if (selectedDdp1.length == 5) {
            alert("You can select maximum 5 columns");
        }
        else {
            //$('#SelectedDpdwnlist').empty();
            var availDdp = $('#AvailableDpdwnlist').val();
            var option = "";
            for (var i = 0; i < availDdp.length; i++) {
                option += '<option selected value="' + availDdp[i] + '">' + availDdp[i] + '</option>';
                $("#AvailableDpdwnlist option[value='" + availDdp[i] + "']").remove();
            }
            $('#SelectedDpdwnlist').append(option);
        }
    }

    function DisSelectDrpdwn() {
        var selectedDdp = $('#SelectedDpdwnlist').val();
        var option = "";
        for (var i = 0; i < selectedDdp.length; i++) {
            option += '<option value="' + selectedDdp[i] + '">' + selectedDdp[i] + '</option>';
            $("#SelectedDpdwnlist option[value='" + selectedDdp[i] + "']").remove();
        }
        $('#AvailableDpdwnlist').append(option);
    }

    function Run() {
        var options1 = $('#SelectedDpdwnlist option');
        var selectedDdp1 = $.map(options1, function (option) {
            return option.value;
        });
        var options = $('#SelectedDpdwnlist option');
        if (options.length == 0) {
            $('#checkboxErr').text('Please select the minimum one column');
        } else if (selectedDdp1.length > 5) {
            alert("Please select maximum 5 columns");
        }
        else {
              var options = $('#SelectedDpdwnlist option');
              var selectedDdp = $.map(options, function (option) {
              return option.value;
              });
              var TableName = $('#Tables').val();
              var dbName = $('#Databases').val();

              Data = {
                   DataBase: dbName,
                   TableName: TableName,
                   ColumnNames: selectedDdp
              }

                    $.ajax({
                        type: "POST",
                        url:'@Url.Action("GetColumnData", "MSSQL")',
                        data: ko.toJSON(Data),
                        contentType: "application/json",
                        success: function (data) {
                            $("#HashTable").empty();
                            var response = JSON.parse(data);
                            var head = "<thead class='thead-inverse'><tr>";
                            $.each(response[0], function (k, v) {
                                head = head + "<th scope='row' style='content-align:left;'>" + k.toString() + "</th>";
                            })
                            head = head + "<th>QR Code</th><th>BarCode</th><th style='display:none;'>json</th></thead></tr>";

                            $("#HashTable ").append(head);
                            var body = "<tbody><tr>";
                            var jsonBarcode;
                            $.each(response, function (index, value) {
                                jsonBarcode = jsonConstruct(index, value);
                                body = body + "<tr>";
                                $.each(value, function (key, val) {
                                    body = body + "<td>" + val + "</td>";
                                })
                                body = body + "<td><a data-toggle='modal' data-target='#myModal' onclick='GenerateQRcode(" + jsonBarcode + ")' ><img src='../images/qrcode.png' alt='qrcode' width='25' height='25'/></a></td><td><a data-toggle='modal' onclick='GenerateBarcode(" + jsonBarcode +")' data-target='#myModal2' ><img src='../images/barcode.png' alt='barcode' width='25' height='25'/></a>"
                                    + " </td > <td style='display:none;'>" +
                                    jsonBarcode
                                +"</td></tr > ";
                            })
                            body = body + "</tbody>";
                            $("#userTable").hide();
                            $("#SearchTable").hide();
                            $("#HashTable").show();
                            $("#HashTable").append(body);//append body
                        },
                        error: function (error) {
                            alert(error.status + " " + error.statusText);
                        }
                    });
        }

    }

    function jsonConstruct(index, Value) {
        jsonObj = [];
        $.each(Value, function (key, val) {
            item = {}
            item[key] = val;
            jsonObj.push(item);
        })
        return JSON.stringify(jsonObj);
    }

    function GenerateQRcode(jsonBarcode) {
        $('#barcode').attr("src", "");
        $('#barcodeLbl').text("");
        var Data1 = ko.toJSON(jsonBarcode);
        $.ajax({
            type: "GET",
            url: '@Url.Action("SingleQRCode", "MSSQL")',
            data: { "Text": Data1},
            contentType: "application/json",
            success: function (data) {
                $('#qrCode').attr("src", data);
                $('#qrcodeLbl').text(Data1);
            },
            error: function (error) {
                alert(error.status + " " + error.statusText);
            }
        });
    }
    function GenerateBarcode(jsonBarcode) {
        $('#barcode').attr("src", "");
        $('#barcodeLbl').text("");
        var Data1 = ko.toJSON(jsonBarcode);
        $.ajax({
            type: "GET",
            url: '@Url.Action("SingleBarCode", "MSSQL")',
            data: { "Text": Data1 },
            contentType: "application/json",
            success: function (data) {
                $('#barcode').attr("src", data);
                $('#barcodeLbl').text(Data1);
            },
            error: function (error) {
                alert(error.status + " " + error.statusText);
            }
        });
    }

    function changeToTableFilter() {
        $("#tableFilter").css("color", "gray");
        $("#tableFilter").css("background-color", "white");
        $("#defaultOpen").css("background-color", "#f1f1f1");
        $("#defaultOpen").css("color", "cornflowerblue");
        $("#dbFilter").css("background-color", "#f1f1f1");
        $("#dbFilter").css("color", "cornflowerblue");

    }

    function changeToColumnFilter() {
        $("#tableFilter").css("color", "cornflowerblue");
        $("#tableFilter").css("background-color", "#f1f1f1");
        $("#defaultOpen").css("background-color", "#f1f1f1");
        $("#defaultOpen").css("color", "cornflowerblue");
        $("#dbFilter").css("color", "gray");
        $("#dbFilter").css("background-color", "white");

    }

    function BackToDbFilter() {
        $("#tableFilter").css("background-color", "#f1f1f1");
        $("#tableFilter").css("color", "cornflowerblue");
        $("#defaultOpen").css("color", "gray");
        $("#defaultOpen").css("background-color", "white");
        $("#dbFilter").css("background-color", "#f1f1f1");
        $("#dbFilter").css("color", "cornflowerblue");

    }

    function ImagetoPrint(source) {
        return "<html><head><scri" + "pt>function step1(){\n" +
            "setTimeout('step2()', 10);}\n" +
            "function step2(){window.print();window.close()}\n" +
            "</scri" + "pt></head><body onload='step1()'>\n" +
            "<img src='" + source + "' /></body></html>";
    }
    function PrintImage(lbl) {
        var source = $('#' +lbl).attr('src');
        var Pagelink = "about:blank";
        var pwa = window.open(Pagelink, "_new");
        pwa.document.open();
        pwa.document.write(ImagetoPrint(source));
        pwa.document.close();
    }

</script>

